## Singleton Pattern

### Singleton Pattern 이란
> 생성자가 여러 차례 호출되더라도 실제로 생성되는 객체는 하나이고 최소 생성 이후에 호출된 생성자는
> 최초의 생성자가 생성한 객체를 리턴하는 디자인 유형

애플리케이션이 시작될 때 어떤 클래스가 `최초 한번만` 메모리를 할당하고(static) 그 메모리에 인스턴스를 만들어 사용하는 디자인 패턴을 `싱글톤 패턴`이라고 한다.<br />
쉽게 말해 하나의 인스턴스를 생성하고 그 이후에는 동일한 인스턴스를 사용하는 패턴이다.<br />

프로그램 내에서 객체를 공유해서 사용해야할 때, 프로그램 내에서 하나의 객체만 존재해야할 때 사용한다.<br />

### 사용 이유 (=장점)
객체를 생성하면 생성할 때마다 메모리 영역을 할당해야하는데, 싱글톤 패턴을 사용한다면 한번의 생성만 하기 때문에 메모리 낭비를 줄일 수 있다.<br />
또한 이미 생성된 인스턴스를 활용하기 때문에 속도 측면에서 이점도 있다고 한다.<br />
객체의 유일성을 보장할 수 있고, 싱글톤 객체는 전역으로 사용되기 때문에 어디에서나 싱글턴 객체에 접근할 수 있다.<br />

이러한 이유로 `DBCP(DataBase Connection Pool)`처럼 공통된 객체를 여러개 생성해서 사용해야하는 상황에서 많이 사용된다.
(데이터베이스에서 connection pool, thread pool, cache, 로그 기록 객체 등..)<br />

### 단점
전역으로 사용하는 인스턴스이기 때문에 동시성 문제가 발생할 수 있기 때문에 이 부분을 유의해 설계해야한다.<br />싱글톤 패턴을 적용할 때 동시성 문제를 고ㄹ사용할 경우 인스ㅌ
또한 싱글톤 인스턴스가 너무 많은 일을 하거나 많은 데이터를 공유시킬 경우, 다른 클래스의 인스턴스들 간에 결합도가 높아질 수 있다.<br />
객체 지향 설계 원칙 중에 `개방-폐쇄 원칙`이 있는데 위의 상황은 이 원칙을 위배하게 된다.<br />

멀티 스레드 환경에서 사용할 경우에는 동기화처리를 하지 않으면 인스턴스가 2개가 생성될 수 있기도 하기 때문에<br />
모든 디자인 패턴이 마찬가지겠지만 사용해야하는 상황을 잘 판단하고 설계한 후에 사용하는 것이 좋을 것 같다.<br />

### Nestjs와 싱글톤 패턴
Nestjs는 모듈을 주입하는 과정을 통해 알아서 싱글톤 인스턴스를 생성한다.<br />
nestjs가 정확히 어떻게 인스턴스를 생성해서 관리하는지는 잘 모르고 싱글톤이다~ 정도만 알고 있었는데,<br />
[이 글](https://jay-ji.tistory.com/106)을 보고 <br />
nestjs에서 singleton 인스턴스를 생성하는 범위는 module, providers 범위로 생성한다는걸 알게 되었다.